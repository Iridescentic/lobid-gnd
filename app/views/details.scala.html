@* Copyright 2017 Fabian Steeg, hbz. Licensed under the GPLv2 *@

@(resource: models.AuthorityResource)

@import play.api.libs.json._

@image() = {
    <img src='@resource.entityFacts.getImage.image' style="max-height:500px;" class="center-block"/>
    <div class='text-center small'><br/>@Html(resource.entityFacts.getImage.label)</div>
}

@main("", "lobid-gnd - Details") {
    <div class="page-header">
        <h1>@resource.title <small>&mdash; @resource.subtitle 
            <div class='pull-right'>
            <a title="JSON-LD in Lobid-GND anzeigen" href='@routes.HomeController.authorityDotFormat(resource.getId, "json")'><img class='json-ld-icon' src='@routes.Assets.versioned("images/favicon.png")'/></a>
            <a title="JSON-LD in EntityFacts anzeigen" href='@(controllers.HomeController.config("entityfacts.live")+resource.getId)'><img class='json-ld-icon' src='@routes.Assets.versioned("images/entityfacts.png")'/></a>
            </div>
            </small>
        </h1>
    </div>
    <div class="row">
        <div class="col-md-@(if(resource.location == null && resource.entityFacts.depiction == null){12}else{6}) intro">
            <table class='table table-striped table-condensed'>
            @for(f <- resource.generalFields; values = f.getRight.split("; ")) {
                <tr><td>@f.getLeft</td><td class='field-value'>
                @if(values.length > 3){
                    @Html(values.take(3).mkString("; ")) <span title="@(f.getRight)" class="fa fa-ellipsis-h"></span>
                } else {
                    @Html(f.getRight)
                }</td>
            }
            @for(f <- resource.additionalLinks) {
              <tr><td>@f.getLeft</td><td>@Html(f.getRight)</td>
            }
            </table>
        </div>
        @if(resource.location != null){
        <div class="col-md-@if(resource.location != null && resource.entityFacts.depiction != null){3}else{6} intro">
            @if(resource.location != null) {
            <link rel="stylesheet" href='@controllers.routes.Assets.versioned("stylesheets/leaflet.css")' />
            <script src='@controllers.routes.Assets.versioned("javascripts/leaflet.js")'></script>
            <div id="authority-map" class="authority-map"></div>
            <script async type='text/javascript'>
              var layer = L.tileLayer('https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
              });
              var center = new L.LatLng(@resource.location.getLat, @resource.location.getLon)
              var map = new L.Map("authority-map", {
               center: center,
               zoom: @if(resource.getType.contains("Country")) {3} else {@if(resource.getType.contains("MemberState")) {5} else {10}},
               scrollWheelZoom: true,
               attributionControl: true,
               zoomControl: true
              });
              var marker = L.marker(center,{
                title: '@resource.title'
              });
              marker.addTo(map);
              map.addLayer(layer);
            </script>
            }
            @if(resource.location == null && !resource.entityFacts.getImage.image.isEmpty){
                @image()
            }
        </div>
        }
        @if(resource.entityFacts.depiction != null){
             <div class="col-md-@if(resource.location != null){3}else{6} intro">
                 @image()
             </div>
        }
    </div>
}
